# ì¸ê¸° ê²€ìƒ‰ íšŒì‚¬ ê¸°ëŠ¥ ëª…ì„¸ì„œ

## ğŸ“‹ ê¸°ëŠ¥ ê°œìš”

ê²€ìƒ‰ í˜ì´ì§€ ì´ˆê¸° í™”ë©´(ê²€ìƒ‰ì–´ ì…ë ¥ ì „)ì— **ë§ì´ ê²€ìƒ‰ëœ íšŒì‚¬ ëª©ë¡**ì„ í‘œì‹œí•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.

### ëª©ì 

- ê²€ìƒ‰ í˜ì´ì§€ ì§„ì… ì‹œ ë¹ˆ í™”ë©´ ëŒ€ì‹  ìœ ìš©í•œ ì •ë³´ ì œê³µ
- ë‹¤ë¥¸ íˆ¬ììë“¤ì´ ê´€ì‹¬ ìˆëŠ” íšŒì‚¬ë¥¼ ë¹ ë¥´ê²Œ íƒìƒ‰
- í´ë¦­ í•œ ë²ˆìœ¼ë¡œ í•´ë‹¹ íšŒì‚¬ì˜ ê³µì‹œ ê²€ìƒ‰ ê²°ê³¼ë¡œ ì´ë™

### ì°¸ê³  ì´ë¯¸ì§€

í† ìŠ¤ ì¦ê¶Œ ê²€ìƒ‰ í™”ë©´ì˜ "ì¸ê¸° ì£¼ì‹" ì„¹ì…˜ê³¼ ìœ ì‚¬í•œ UIë¥¼ ì°¸ê³ í•©ë‹ˆë‹¤.

---

## ğŸ¯ ìš”êµ¬ì‚¬í•­

### 1. ì¸ê¸° ê²€ìƒ‰ íšŒì‚¬ ëª©ë¡

- **ìœ„ì¹˜**: ê²€ìƒ‰ í˜ì´ì§€ì—ì„œ ê²€ìƒ‰ì–´ ì…ë ¥ ì „ ì´ˆê¸° í™”ë©´
- **í‘œì‹œ ê°œìˆ˜**: ìµœëŒ€ 10ê°œ
- **í‘œì‹œ ì •ë³´**:
  - ìˆœìœ„ (1~10)
  - íšŒì‚¬ëª…
  - ì¢…ëª©ì½”ë“œ (ìš°ì¸¡, ë³´ì¡° í…ìŠ¤íŠ¸)
- **ë™ì‘**:
  - í•­ëª© í´ë¦­ ì‹œ í•´ë‹¹ íšŒì‚¬ëª…ìœ¼ë¡œ ê³µì‹œ ê²€ìƒ‰ ì‹¤í–‰
  - ëª©ë¡ì€ ìµœê·¼ 24ì‹œê°„ ê¸°ì¤€ ê²€ìƒ‰ íšŸìˆ˜ ì§‘ê³„

### 2. ê²€ìƒ‰ ë¡œê·¸ ê¸°ë¡

- ì‚¬ìš©ìê°€ ê³µì‹œ ê²€ìƒ‰ì„ ì‹¤í–‰í•  ë•Œë§ˆë‹¤ ê²€ìƒ‰ ë¡œê·¸ë¥¼ ê¸°ë¡
- ê¸°ë¡ ì‹œì : ê²€ìƒ‰ API í˜¸ì¶œ ì‹œ ì„œë²„ì—ì„œ ë¹„ë™ê¸°ë¡œ ê¸°ë¡
- ê¸°ë¡ ì •ë³´: ê²€ìƒ‰ì–´, ê²€ìƒ‰ ì‹œê°

### 3. ë…¸ì¶œ ì¡°ê±´

- ê²€ìƒ‰ í˜ì´ì§€ ì´ˆê¸° ìƒíƒœ (ê²€ìƒ‰ì–´ê°€ ì—†ê³ , ìë™ì™„ì„± ë“œë¡­ë‹¤ìš´ì´ ë‹«í˜€ ìˆì„ ë•Œ)
- ì¸ê¸° ê²€ìƒ‰ íšŒì‚¬ê°€ 0ê±´ì´ë©´ ì„¹ì…˜ ìì²´ë¥¼ ìˆ¨ê¹€

---

## ğŸ¨ UI/UX ìƒì„¸

### ê²€ìƒ‰ í˜ì´ì§€ ì´ˆê¸° í™”ë©´

#### ëª¨ë°”ì¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† ë’¤ë¡œ                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ğŸ”  íšŒì‚¬ëª…ì„ ê²€ìƒ‰í•˜ì„¸ìš”           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                         â”‚
â”‚  ì¸ê¸° ê²€ìƒ‰ íšŒì‚¬                          â”‚
â”‚                                         â”‚
â”‚   1   ì‚¼ì„±ì „ì                  005930   â”‚
â”‚   2   SKí•˜ì´ë‹‰ìŠ¤                000660   â”‚
â”‚   3   LGì—ë„ˆì§€ì†”ë£¨ì…˜            373220   â”‚
â”‚   4   í˜„ëŒ€ìë™ì°¨                005380   â”‚
â”‚   5   ì¹´ì¹´ì˜¤                   035720   â”‚
â”‚   6   ë„¤ì´ë²„                   035420   â”‚
â”‚   7   ì‚¼ì„±SDI                  006400   â”‚
â”‚   8   ì…€íŠ¸ë¦¬ì˜¨                  068270   â”‚
â”‚   9   í¬ìŠ¤ì½”í™€ë”©ìŠ¤              005490   â”‚
â”‚  10   ê¸°ì•„                     000270   â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### PC

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† ë’¤ë¡œ   ê³µì‹œ ê²€ìƒ‰                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â” â”Œâ”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ”  íšŒì‚¬ëª…ì„ ê²€ìƒ‰í•˜ì„¸ìš”                                    â”‚ â”‚âš™â”‚ â”‚ê²€ìƒ‰â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”˜ â””â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â”‚  ì¸ê¸° ê²€ìƒ‰ íšŒì‚¬                                                              â”‚
â”‚                                                                              â”‚
â”‚   1   ì‚¼ì„±ì „ì                                                     005930   â”‚
â”‚   2   SKí•˜ì´ë‹‰ìŠ¤                                                   000660   â”‚
â”‚   3   LGì—ë„ˆì§€ì†”ë£¨ì…˜                                               373220   â”‚
â”‚   4   í˜„ëŒ€ìë™ì°¨                                                   005380   â”‚
â”‚   5   ì¹´ì¹´ì˜¤                                                      035720   â”‚
â”‚   ...                                                                       â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œ

- ìˆœìœ„ ë²ˆí˜¸: ê³ ì • ë„ˆë¹„, `text-muted-foreground`
- íšŒì‚¬ëª…: `text-foreground`, ì¢Œì¸¡ ì •ë ¬
- ì¢…ëª©ì½”ë“œ: `text-muted-foreground`, ìš°ì¸¡ ì •ë ¬
- hover ì‹œ `interactive-card` ìŠ¤íƒ€ì¼ ì ìš© (ê¸°ì¡´ ê²€ìƒ‰ suggest ëª©ë¡ê³¼ ë™ì¼)

---

## ğŸ”§ ê¸°ìˆ  êµ¬í˜„ ë°©ì•ˆ

### DB ìŠ¤í‚¤ë§ˆ

#### SearchLog í…Œì´ë¸”

```prisma
model SearchLog {
  id        Int      @id @default(autoincrement())
  query     String   // ê²€ìƒ‰ì–´ (íšŒì‚¬ëª…)
  createdAt DateTime @default(now()) @map("created_at")

  @@index([createdAt])
  @@index([query, createdAt])
  @@map("search_logs")
}
```

### ì•„í‚¤í…ì²˜ (FSD)

```
apps/web/
â”œâ”€â”€ app/
â”‚   â””â”€â”€ api/
â”‚       â””â”€â”€ stocks/
â”‚           â””â”€â”€ popular/
â”‚               â””â”€â”€ route.ts                    # ì¸ê¸° ê²€ìƒ‰ íšŒì‚¬ API
â”‚
â”œâ”€â”€ widgets/
â”‚   â””â”€â”€ disclosure-search/
â”‚       â””â”€â”€ ui/
â”‚           â””â”€â”€ popular-companies.tsx            # ì¸ê¸° ê²€ìƒ‰ íšŒì‚¬ UI
â”‚
â”œâ”€â”€ entities/
â”‚   â””â”€â”€ disclosure/
â”‚       â”œâ”€â”€ api/
â”‚       â”‚   â””â”€â”€ get-popular-companies.ts         # API í˜¸ì¶œ í•¨ìˆ˜
â”‚       â””â”€â”€ model/
â”‚           â””â”€â”€ use-popular-companies.ts         # React Query í›…
â”‚
â””â”€â”€ shared/
    â””â”€â”€ lib/
        â””â”€â”€ query-keys.ts                       # stocks.popular í‚¤ ì¶”ê°€
```

### API ì„¤ê³„

#### ì¸ê¸° ê²€ìƒ‰ íšŒì‚¬ ì¡°íšŒ API

```
GET /api/stocks/popular?limit=10
```

**ì‘ë‹µ**:

```json
{
  "companies": [
    {
      "rank": 1,
      "corpName": "ì‚¼ì„±ì „ì",
      "stockCode": "005930",
      "searchCount": 142
    },
    ...
  ],
  "updatedAt": "2026-02-02T10:00:00.000Z"
}
```

**ë¡œì§**:

1. `search_logs` í…Œì´ë¸”ì—ì„œ ìµœê·¼ 24ì‹œê°„ ê¸°ë¡ì„ ì§‘ê³„
2. ê²€ìƒ‰ì–´ë³„ íšŸìˆ˜ë¥¼ ì¹´ìš´íŠ¸í•˜ì—¬ ìƒìœ„ Nê°œ ë°˜í™˜
3. Stock í…Œì´ë¸”ê³¼ ì¡°ì¸í•˜ì—¬ ì¢…ëª©ì½”ë“œ ë§¤í•‘

```sql
SELECT sl.query AS corp_name, s.stock_code, COUNT(*) AS search_count
FROM search_logs sl
LEFT JOIN stocks s ON s.corp_name = sl.query
WHERE sl.created_at >= NOW() - INTERVAL '24 hours'
GROUP BY sl.query, s.stock_code
ORDER BY search_count DESC
LIMIT 10;
```

#### ê²€ìƒ‰ ë¡œê·¸ ê¸°ë¡

ê¸°ì¡´ `/api/disclosures/search` routeì—ì„œ ê²€ìƒ‰ ì‹¤í–‰ ì‹œ ë¹„ë™ê¸°ë¡œ ê¸°ë¡í•©ë‹ˆë‹¤.

```typescript
// app/api/disclosures/search/route.ts (ê¸°ì¡´ íŒŒì¼ ìˆ˜ì •)
// ê²€ìƒ‰ ì„±ê³µ ì‹œ ë¡œê·¸ ê¸°ë¡ (ì‘ë‹µì„ ì§€ì—°ì‹œí‚¤ì§€ ì•Šë„ë¡ await ì—†ì´ ì‹¤í–‰)
if (q) {
  prisma.searchLog.create({ data: { query: q } }).catch(() => {})
}
```

### íƒ€ì… ì •ì˜

```typescript
// entities/disclosure/model/types.tsì— ì¶”ê°€
export interface PopularCompany {
  rank: number
  corpName: string
  stockCode: string | null
  searchCount: number
}

export interface PopularCompaniesResponse {
  companies: PopularCompany[]
  updatedAt: string
}
```

### React Query ì„¤ì •

```typescript
// entities/disclosure/model/use-popular-companies.ts
import { useSuspenseQuery } from '@tanstack/react-query'

export function usePopularCompanies() {
  return useSuspenseQuery({
    queryKey: queries.stocks.popular(),
    queryFn: () => getPopularCompanies(),
    staleTime: 5 * 60 * 1000, // 5ë¶„ê°„ fresh
  })
}
```

### ì¿¼ë¦¬ í‚¤ ì¶”ê°€

```typescript
// shared/lib/query-keys.ts
export const queries = createQueryKeyStore({
  stocks: {
    suggest: (query: string) => [query],
    popular: null, // ì¶”ê°€
  },
  // ...
})
```

### ìºì‹± ì „ëµ

- **ì„œë²„**: 5ë¶„ ìºì‹œ (`Cache-Control: s-maxage=300`)
- **í´ë¼ì´ì–¸íŠ¸**: `staleTime: 5ë¶„` â€” ì¸ê¸° ê²€ìƒ‰ì–´ëŠ” ìì£¼ ë³€í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ê¸´ ìºì‹œ
- **ê²€ìƒ‰ ë¡œê·¸ ì •ë¦¬**: 7ì¼ ì´ìƒ ëœ ë¡œê·¸ëŠ” ì£¼ê¸°ì ìœ¼ë¡œ ì‚­ì œ (ì¶”í›„ cron job)

---

## ğŸš€ êµ¬í˜„ ë‹¨ê³„

### Phase 1: DB ìŠ¤í‚¤ë§ˆ ë° ê²€ìƒ‰ ë¡œê·¸ ê¸°ë¡

1. `SearchLog` ëª¨ë¸ ì¶”ê°€ (prisma schema)
2. migration ì‹¤í–‰
3. ê¸°ì¡´ ê²€ìƒ‰ APIì— ë¡œê·¸ ê¸°ë¡ ë¡œì§ ì¶”ê°€

### Phase 2: ì¸ê¸° ê²€ìƒ‰ íšŒì‚¬ API

1. `/api/stocks/popular` route handler ìƒì„±
2. ìµœê·¼ 24ì‹œê°„ ê²€ìƒ‰ ë¡œê·¸ ì§‘ê³„ ì¿¼ë¦¬ êµ¬í˜„
3. Stock í…Œì´ë¸” ì¡°ì¸ìœ¼ë¡œ ì¢…ëª©ì½”ë“œ ë§¤í•‘

### Phase 3: í´ë¼ì´ì–¸íŠ¸ UI

1. API í˜¸ì¶œ í•¨ìˆ˜ ë° React Query í›… ìƒì„±
2. `PopularCompanies` ì»´í¬ë„ŒíŠ¸ êµ¬í˜„
3. ê²€ìƒ‰ í˜ì´ì§€ ì´ˆê¸° í™”ë©´ì— í†µí•©
4. Suspense + ErrorBoundary ì„ ì–¸ì  ì²˜ë¦¬

---

## âœ… êµ¬í˜„ í˜„í™©

### ë¯¸ì™„ë£Œ ì‘ì—…

#### Phase 1: DB ìŠ¤í‚¤ë§ˆ ë° ê²€ìƒ‰ ë¡œê·¸ ê¸°ë¡

- [ ] `SearchLog` ëª¨ë¸ ì¶”ê°€ (`prisma/schema.prisma`)
- [ ] prisma migration ì‹¤í–‰
- [ ] ê¸°ì¡´ ê²€ìƒ‰ APIì— ë¡œê·¸ ê¸°ë¡ ì¶”ê°€ (`app/api/disclosures/search/route.ts`)

#### Phase 2: ì¸ê¸° ê²€ìƒ‰ íšŒì‚¬ API

- [ ] ì¸ê¸° ê²€ìƒ‰ íšŒì‚¬ API (`app/api/stocks/popular/route.ts`)
- [ ] API í˜¸ì¶œ í•¨ìˆ˜ (`entities/disclosure/api/get-popular-companies.ts`)
- [ ] React Query í›… (`entities/disclosure/model/use-popular-companies.ts`)
- [ ] ì¿¼ë¦¬ í‚¤ ì¶”ê°€ (`shared/lib/query-keys.ts`)

#### Phase 3: í´ë¼ì´ì–¸íŠ¸ UI

- [ ] `PopularCompanies` ì»´í¬ë„ŒíŠ¸ (`widgets/disclosure-search/ui/popular-companies.tsx`)
- [ ] ê²€ìƒ‰ í˜ì´ì§€ ì´ˆê¸° í™”ë©´ í†µí•© (`widgets/disclosure-search/disclosure-search-page.tsx`)

---

## ğŸ“ ì°¸ê³  ìë£Œ

- ê¸°ì¡´ êµ¬í˜„: `spec/disclosure/disclosure-search.md`
- ê¸°ì¡´ êµ¬í˜„: `widgets/disclosure-search/ui/company-suggestion-list.tsx` (ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ ì°¸ê³ )
- ê¸°ì¡´ êµ¬í˜„: `widgets/disclosure-search/disclosure-search-page.tsx` (ê²€ìƒ‰ í˜ì´ì§€ êµ¬ì¡°)
