# ì¸ê¸° íšŒì‚¬ ì„¹ì…˜ ê¸°ëŠ¥ ëª…ì„¸ì„œ

## ğŸ“‹ ê¸°ëŠ¥ ê°œìš”

ê²€ìƒ‰ íšŸìˆ˜ê°€ ë†’ì€ ì¸ê¸° íšŒì‚¬ë¥¼ ë­í‚¹ í˜•íƒœë¡œ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.

### ëª©ì 

- íˆ¬ììì—ê²Œ ì£¼ëª©ë°›ëŠ” íšŒì‚¬ ì •ë³´ë¥¼ í•œëˆˆì— ì œê³µ
- ì‹œì¥ì˜ ê´€ì‹¬ì‚¬ë¥¼ ë¹ ë¥´ê²Œ íŒŒì•…
- ë©”ì¸ í˜ì´ì§€ ì§„ì… ì‹œ í•µì‹¬ ì •ë³´ ë…¸ì¶œ

---

## ğŸ¯ ìš”êµ¬ì‚¬í•­

### 1. í‘œì‹œ ê°œìˆ˜

- **PC (â‰¥768px)**: 5ê°œ ì¹´ë“œ í‘œì‹œ
- **ëª¨ë°”ì¼ (<768px)**: 3ê°œ ì¹´ë“œ í‘œì‹œ

### 2. ë ˆì´ì•„ì›ƒ

- ì¢Œì—ì„œ ìš°ë¡œ 1ë“±ë¶€í„° ìˆœì„œëŒ€ë¡œ ë°°ì¹˜
- ì¹´ë“œ í˜•ì‹ìœ¼ë¡œ ê°€ë¡œ ì •ë ¬
- ìœ„ì¹˜: ë©”ì¸ í˜ì´ì§€ ë°°ë„ˆ í•˜ë‹¨

### 3. ë°ì´í„° í˜ì¹­ ì „ëµ

- **Server Componentì—ì„œ í”„ë¦¬íŒ¨ì¹˜**
- **HydrationBoundaryë¥¼ í†µí•´ í´ë¼ì´ì–¸íŠ¸ë¡œ ì „ë‹¬**
- í´ë¼ì´ì–¸íŠ¸ì—ì„œ React Queryë¡œ ìƒíƒœ ê´€ë¦¬

### 4. ì„œë²„ ìºì‹±

- ì¸ê¸° íšŒì‚¬ëŠ” ìì£¼ ë³€ê²½ë˜ì§€ ì•ŠëŠ” ë°ì´í„°
- Next.js `fetch` + `next.revalidate` ì˜µì…˜ í™œìš©
- ìºì‹œ ìœ íš¨ê¸°ê°„: **5ë¶„ (300ì´ˆ)**

---

## ğŸ¨ UI/UX ìƒì„¸

### PC ë²„ì „ (â‰¥768px)

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”¥ ì¸ê¸° íšŒì‚¬                                                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  ğŸ¥‡ 1   â”‚  â”‚  ğŸ¥ˆ 2   â”‚  â”‚  ğŸ¥‰ 3   â”‚  â”‚    4    â”‚  â”‚    5    â”‚              â”‚
â”‚  â”‚         â”‚  â”‚         â”‚  â”‚         â”‚  â”‚         â”‚  â”‚         â”‚              â”‚
â”‚  â”‚ íšŒì‚¬ëª…   â”‚  â”‚ íšŒì‚¬ëª…   â”‚  â”‚ íšŒì‚¬ëª…   â”‚  â”‚ íšŒì‚¬ëª…   â”‚  â”‚ íšŒì‚¬ëª…   â”‚              â”‚
â”‚  â”‚         â”‚  â”‚         â”‚  â”‚         â”‚  â”‚         â”‚  â”‚         â”‚              â”‚
â”‚  â”‚ ì¢…ëª©ì½”ë“œ â”‚  â”‚ ì¢…ëª©ì½”ë“œ â”‚  â”‚ ì¢…ëª©ì½”ë“œ â”‚  â”‚ ì¢…ëª©ì½”ë“œ â”‚  â”‚ ì¢…ëª©ì½”ë“œ â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ëª¨ë°”ì¼ ë²„ì „ (<768px)

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”¥ ì¸ê¸° íšŒì‚¬                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ğŸ¥‡ 1   â”‚  â”‚  ğŸ¥ˆ 2   â”‚  â”‚  ğŸ¥‰ 3   â”‚  â”‚
â”‚  â”‚         â”‚  â”‚         â”‚  â”‚         â”‚  â”‚
â”‚  â”‚ íšŒì‚¬ëª…   â”‚  â”‚ íšŒì‚¬ëª…   â”‚  â”‚ íšŒì‚¬ëª…   â”‚  â”‚
â”‚  â”‚         â”‚  â”‚         â”‚  â”‚         â”‚  â”‚
â”‚  â”‚ ì¢…ëª©ì½”ë“œ â”‚  â”‚ ì¢…ëª©ì½”ë“œ â”‚  â”‚ ì¢…ëª©ì½”ë“œ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì¹´ë“œ êµ¬ì„±

- **ìˆœìœ„ í‘œì‹œ**: 1~3ìœ„ëŠ” ë©”ë‹¬ ì•„ì´ì½˜ (ğŸ¥‡ğŸ¥ˆğŸ¥‰), 4~5ìœ„ëŠ” ìˆ«ì
- **íšŒì‚¬ëª…**: 1ì¤„ ë§ì¤„ì„í‘œ ì²˜ë¦¬
- **ì¢…ëª©ì½”ë“œ**: 6ìë¦¬ ì½”ë“œ
- **ì¹´ë“œ í´ë¦­**: íšŒì‚¬ ìƒì„¸ í˜ì´ì§€ ë˜ëŠ” ê²€ìƒ‰ ê²°ê³¼ë¡œ ì´ë™

### ë°˜ì‘í˜• ë¶„ê¸°ì 

- **ëª¨ë°”ì¼**: `< 768px` - 3ê°œ ì¹´ë“œ
- **PC**: `â‰¥ 768px` - 5ê°œ ì¹´ë“œ

---

## ğŸ”§ ê¸°ìˆ  êµ¬í˜„ ë°©ì•ˆ

### ì•„í‚¤í…ì²˜ (FSD)

```text
apps/web/
â”œâ”€â”€ app/
â”‚   â””â”€â”€ page.tsx                              # ë©”ì¸ í˜ì´ì§€ (ì¸ê¸° íšŒì‚¬ í”„ë¦¬íŒ¨ì¹˜)
â”‚
â”œâ”€â”€ widgets/
â”‚   â””â”€â”€ popular-companies-section/
â”‚       â”œâ”€â”€ index.ts
â”‚       â”œâ”€â”€ popular-companies-section.tsx     # ë©”ì¸ ìœ„ì ¯
â”‚       â””â”€â”€ ui/
â”‚           â”œâ”€â”€ index.ts                      # UI ì»´í¬ë„ŒíŠ¸ ë°°ëŸ´ export
â”‚           â”œâ”€â”€ popular-company-card.tsx      # ì¸ê¸° íšŒì‚¬ ì¹´ë“œ
â”‚           â”œâ”€â”€ popular-company-list.tsx      # ì¹´ë“œ ë¦¬ìŠ¤íŠ¸ (ë°˜ì‘í˜•)
â”‚           â””â”€â”€ popular-company-skeleton.tsx  # ë¡œë”© ìŠ¤ì¼ˆë ˆí†¤
â”‚
â”œâ”€â”€ entities/
â”‚   â””â”€â”€ disclosure/
â”‚       â”œâ”€â”€ api/
â”‚       â”‚   â””â”€â”€ popular-companies/
â”‚       â”‚       â”œâ”€â”€ client.ts                 # í´ë¼ì´ì–¸íŠ¸ API í˜¸ì¶œ (ê¸°ì¡´)
â”‚       â”‚       â””â”€â”€ server.ts                 # ì„œë²„ API í˜¸ì¶œ + ìºì‹± (ê¸°ì¡´)
â”‚       â”œâ”€â”€ model/
â”‚       â”‚   â””â”€â”€ types.ts                      # PopularCompany íƒ€ì… (ê¸°ì¡´)
â”‚       â””â”€â”€ queries/
â”‚           â””â”€â”€ prefetch.ts                   # í”„ë¦¬íŒ¨ì¹˜ í•¨ìˆ˜ ì¶”ê°€
â”‚
â””â”€â”€ shared/
    â””â”€â”€ lib/
        â””â”€â”€ query-keys.ts                     # stocks.popular ì¿¼ë¦¬ í‚¤ (ê¸°ì¡´)
```

### ê¸°ì¡´ API í™œìš©

ì¸ê¸° íšŒì‚¬ ë°ì´í„°ëŠ” ì´ë¯¸ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤:

```typescript
// entities/disclosure/api/popular-companies/server.ts (ê¸°ì¡´)
export async function getPopularCompaniesFromDB(limit: number = 10)

// entities/disclosure/model/types.ts (ê¸°ì¡´)
export interface PopularCompany {
  rank: number
  corpName: string
  stockCode: string
  searchCount: number
}
```

### í”„ë¦¬íŒ¨ì¹˜ í•¨ìˆ˜ ì¶”ê°€

```typescript
// entities/disclosure/queries/prefetch.ts (ì¶”ê°€)

const STALE_TIME_5_MIN = 5 * 60 * 1000

/**
 * [ì„œë²„ ì»´í¬ë„ŒíŠ¸ìš©] ì¸ê¸° íšŒì‚¬ ë°ì´í„°ë¥¼ prefetchí•©ë‹ˆë‹¤
 * @param limit - ì¡°íšŒí•  ìµœëŒ€ ê±´ìˆ˜ (ê¸°ë³¸ê°’: 5)
 * @returns Dehydrated state (HydrationBoundaryì— ì „ë‹¬)
 */
export async function prefetchPopularCompanies(limit: number = 5) {
  const queryClient = new QueryClient()

  await queryClient.prefetchQuery({
    queryKey: queries.stocks.popular(limit).queryKey,
    queryFn: () => getPopularCompaniesFromDB(limit),
    staleTime: STALE_TIME_5_MIN,
  })

  return dehydrate(queryClient)
}
```

### ë©”ì¸ í˜ì´ì§€ í†µí•©

```typescript
// app/page.tsx
import { HydrationBoundary } from '@tanstack/react-query'
import { prefetchTodayDisclosures, prefetchPopularCompanies } from '@/entities/disclosure/server'
import { PopularCompaniesSection } from '@/widgets/popular-companies-section'

export default async function Home() {
  // ë³‘ë ¬ë¡œ í”„ë¦¬íŒ¨ì¹˜ (ê°œë³„ ì‹¤íŒ¨ í—ˆìš©)
  const [todayResult, popularResult] = await Promise.allSettled([
    prefetchTodayDisclosures('all', 6),
    prefetchPopularCompanies(5),
  ])

  // ì„±ê³µí•œ ê²°ê³¼ë§Œ ë³‘í•©
  const dehydratedState = {
    mutations: [],
    queries: [
      ...(todayResult.status === 'fulfilled' ? todayResult.value.queries : []),
      ...(popularResult.status === 'fulfilled' ? popularResult.value.queries : []),
    ],
  }

  return (
    <HydrationBoundary state={dehydratedState}>
      <main>
        <ServiceBanner />
        <PopularCompaniesSection />
        <TodayDisclosures />
      </main>
    </HydrationBoundary>
  )
}
```

### í´ë¼ì´ì–¸íŠ¸ í›…

ê¸°ì¡´ `usePopularCompanies` í›…ì„ í™œìš©í•©ë‹ˆë‹¤:

```typescript
// entities/disclosure/queries/hooks.ts (ê¸°ì¡´)
export function usePopularCompanies(limit = 10) {
  return useSuspenseQuery({
    queryKey: queries.stocks.popular(limit).queryKey,
    queryFn: () => getPopularCompanies(limit),
    staleTime: 5 * 60 * 1000, // 5ë¶„
  })
}
```

---

## ğŸš€ êµ¬í˜„ ë‹¨ê³„

### Phase 1: í”„ë¦¬íŒ¨ì¹˜ ì¶”ê°€

1. **í”„ë¦¬íŒ¨ì¹˜ í•¨ìˆ˜ ì¶”ê°€**
   - `prefetchPopularCompanies` í•¨ìˆ˜ êµ¬í˜„
   - `entities/disclosure/server.ts`ì— export ì¶”ê°€

2. **ë©”ì¸ í˜ì´ì§€ í†µí•©**
   - `Promise.allSettled`ë¡œ ë³‘ë ¬ í”„ë¦¬íŒ¨ì¹˜
   - ìƒíƒœ ë³‘í•©

### Phase 2: UI ì»´í¬ë„ŒíŠ¸

1. **ì¹´ë“œ ì»´í¬ë„ŒíŠ¸**
   - `popular-company-card.tsx`
   - ìˆœìœ„ í‘œì‹œ (ë©”ë‹¬/ìˆ«ì)

2. **ë¦¬ìŠ¤íŠ¸ ì»´í¬ë„ŒíŠ¸**
   - `popular-company-list.tsx`
   - ë°˜ì‘í˜• ê°œìˆ˜ ì¡°ì ˆ (3ê°œ/5ê°œ)
   - ê°€ë¡œ ì •ë ¬

3. **ìŠ¤ì¼ˆë ˆí†¤**
   - `popular-company-skeleton.tsx`

### Phase 3: ë©”ì¸ ìœ„ì ¯ í†µí•©

1. **ìœ„ì ¯ ì¡°í•©**
   - `popular-companies-section.tsx`
   - Suspense + ErrorBoundary ì²˜ë¦¬

2. **ë©”ì¸ í˜ì´ì§€ ë°°ì¹˜**
   - ë°°ë„ˆ í•˜ë‹¨ì— ìœ„ì¹˜
   - ê¸°ì¡´ `TodayDisclosures`ì™€ ì¡°í™”

---

## ğŸ“Š ì„±ëŠ¥ ëª©í‘œ

- **ì„œë²„ ìºì‹œ íˆíŠ¸ìœ¨**: 95% ì´ìƒ
- **ì´ˆê¸° ë¡œë”©**: í”„ë¦¬íŒ¨ì¹˜ë¡œ ì¦‰ì‹œ ë Œë”ë§
- **ìºì‹œ ê°±ì‹  ì£¼ê¸°**: 5ë¶„

---

## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] í”„ë¦¬íŒ¨ì¹˜ í•¨ìˆ˜ ì¶”ê°€ (`prefetchPopularCompanies`)
- [ ] ì„œë²„ export ì¶”ê°€
- [ ] ë©”ì¸ í˜ì´ì§€ í”„ë¦¬íŒ¨ì¹˜ í†µí•©
- [ ] ì¹´ë“œ ì»´í¬ë„ŒíŠ¸ (`popular-company-card.tsx`)
- [ ] ë¦¬ìŠ¤íŠ¸ ì»´í¬ë„ŒíŠ¸ (`popular-company-list.tsx`)
- [ ] ìŠ¤ì¼ˆë ˆí†¤ ì»´í¬ë„ŒíŠ¸
- [ ] ìœ„ì ¯ í†µí•© (`popular-companies-section.tsx`)
- [ ] ë°˜ì‘í˜• í…ŒìŠ¤íŠ¸ (PC 5ê°œ / ëª¨ë°”ì¼ 3ê°œ)

---

## ğŸ“ ì°¸ê³  ìë£Œ

- [Next.js Data Fetching (fetch + revalidate)](https://nextjs.org/docs/app/building-your-application/data-fetching)
- [TanStack Query Hydration](https://tanstack.com/query/latest/docs/framework/react/guides/ssr)
- [ì˜¤ëŠ˜ì˜ ê³µì‹œ ëª…ì„¸ì„œ](./today-disclosures.md)
